<div class="dashboard-container">
  <!-- Header -->
  <div class="dashboard-header">
    <h1>Dashboard del Proveedor</h1>
    <div class="user-info">
      <span>Bienvenido, {{ getCurrentUser()?.firstName }} {{ getCurrentUser()?.lastName }}</span>
    </div>
  </div>

  <!-- Mensajes -->
  <div class="messages" *ngIf="successMessage || errorMessage">
    <div class="alert alert-success" *ngIf="successMessage">
      {{ successMessage }}
    </div>
    <div class="alert alert-error" *ngIf="errorMessage">
      {{ errorMessage }}
    </div>
  </div>

  <!-- Productos Section -->
  <div class="products-section">
    <div class="section-header">
      <h2>Mis Productos</h2>
      <button class="btn btn-primary" (click)="showCreateProductForm()" [disabled]="isLoading">
        <i class="icon">+</i> Nuevo Producto
      </button>
    </div>

    <!-- Loading Spinner -->
    <div class="loading" *ngIf="isLoading">
      <div class="spinner"></div>
      <p>Cargando...</p>
    </div>

    <!-- Formulario de Crear/Editar Producto -->
    <div class="form-modal" *ngIf="showCreateForm || showEditForm">
      <div class="form-backdrop" (click)="cancelForm()"></div>
      <div class="form-container">
        <div class="form-header">
          <h3>{{ showCreateForm ? 'Crear Nuevo Producto' : 'Editar Producto' }}</h3>
          <button class="btn-close" (click)="cancelForm()">√ó</button>
        </div>
        
        <form (ngSubmit)="showCreateForm ? createProduct() : updateProduct()" #productFormRef="ngForm">
          <div class="form-group">
            <label for="name">Nombre del Producto *</label>
            <input 
              type="text" 
              id="name" 
              [(ngModel)]="productForm.name" 
              name="name"
              required
              class="form-control"
              placeholder="Ingrese el nombre del producto">
          </div>

          <div class="form-group">
            <label for="description">Descripci√≥n</label>
            <textarea 
              id="description" 
              [(ngModel)]="productForm.description" 
              name="description"
              class="form-control"
              rows="3"
              placeholder="Descripci√≥n del producto (opcional)"></textarea>
          </div>

          <div class="form-row">
            <div class="form-group">
              <label for="price">Precio *</label>
              <input 
                type="number" 
                id="price" 
                [(ngModel)]="productForm.price" 
                name="price"
                required
                min="0.01"
                step="0.01"
                class="form-control"
                placeholder="0.00">
            </div>

            <div class="form-group">
              <label for="stock">Stock *</label>
              <input 
                type="number" 
                id="stock" 
                [(ngModel)]="productForm.stock" 
                name="stock"
                required
                min="0"
                class="form-control"
                placeholder="0">
            </div>
          </div>

          <div class="form-actions">
            <button type="button" class="btn btn-secondary" (click)="cancelForm()">
              Cancelar
            </button>
            <button 
              type="submit" 
              class="btn btn-primary"
              [disabled]="!productFormRef.form.valid || isLoading">
              {{ showCreateForm ? 'Crear Producto' : 'Actualizar Producto' }}
            </button>
          </div>
        </form>
      </div>
    </div>

    <!-- Lista de Productos -->
    <div class="products-grid" *ngIf="!isLoading">
      <div class="product-card" *ngFor="let product of products; trackBy: trackByProductId">
        <div class="product-header">
          <h3>{{ product.name }}</h3>
          <div class="product-actions">
            <button class="btn btn-sm btn-secondary" (click)="showEditProductForm(product)">
              <i class="icon">‚úèÔ∏è</i> Editar
            </button>
            <button class="btn btn-sm btn-danger" (click)="deleteProduct(product)">
              <i class="icon">üóëÔ∏è</i> Eliminar
            </button>
          </div>
        </div>
        
        <div class="product-body">
          <p class="product-description" *ngIf="product.description">
            {{ product.description }}
          </p>
          
          <div class="product-details">
            <div class="detail-item">
              <span class="label">Precio:</span>
              <span class="value price">${{ product.price | number:'1.2-2' }}</span>
            </div>
            <div class="detail-item">
              <span class="label">Stock:</span>
              <span class="value stock" [class.low-stock]="product.stock <= 10">
                {{ product.stock }} unidades
              </span>
            </div>
          </div>
        </div>
        
        <div class="product-footer">
          <small class="text-muted">
            Creado: {{ product.createdAt | date:'short' }}
            <span *ngIf="product.updatedAt !== product.createdAt">
              | Actualizado: {{ product.updatedAt | date:'short' }}
            </span>
          </small>
        </div>
      </div>
    </div>

    <!-- Empty State -->
    <div class="empty-state" *ngIf="!isLoading && products.length === 0">
      <div class="empty-icon">üì¶</div>
      <h3>No tienes productos registrados</h3>
      <p>Comienza creando tu primer producto haciendo clic en "Nuevo Producto"</p>
      <button class="btn btn-primary" (click)="showCreateProductForm()">
        Crear Mi Primer Producto
      </button>
    </div>
  </div>
</div>

